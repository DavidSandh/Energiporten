
@{
    ViewBag.Title = "IndexRegister";
}
@model Energiporten.Models.RegisterModel

<h3>Registrera</h3>
<form method="post" action="SubmitUser">
	
	<div id="loginInfo" class="form-group">
		<div class="stepwizard">
			<div class="stepwizard-row">
				<div class="stepwizard-step">
					<a type="button" class="btn btn-primary btn-circle">1</a>
					<p>Registrera Email  </p>
				</div>
				<div class="stepwizard-step">
					<a type="button" class="btn btn-default btn-circle">2</a>
					<p>Personlig Information</p>
				</div>
				<div class="stepwizard-step">
					<button type="button" class="btn btn-default btn-circle">3</button>
					<p>Val av Brf</p>
				</div>

			</div>
		</div>
		<form action="https://www.energiporten.se/" method="get" class="form-horizontal login">
			<fieldset>
				<div class="form-group">
					<input type="text" name="email" class="form-control field" id="email" placeholder="E-postadress" required />
				</div>
				<div id="emailMessage"></div>
				<div class="form-group">
					<input type="password" id="password" name="password" class="form-control field" placeholder="Lösenord" required />
				</div>
				<div class="form-group">
					<input type="password" id="passwordAgain" name="passwordAgain" class="form-control field" placeholder="Upprepa lösenord" required />
				</div>
				<div id="passwordMessage"></div>
				<div class="form-group">

					<input type="submit" id="clickLogin" class="center-block btn btn-info" value="nästa" />


				</div>
			</fieldset>
	</div>
	<div id="personalInfo"></div>
	<div id="brfInfo"></div>
</form>
<script>
    $('#clickLogin').click(function () {
        $.ajax({
            url: 'ShowPersonalInfo',
            type: 'GET',
            error: function () {
                console.log("Error");
            },
            success: function (data) {
                $('#personalInfo').append(data);
                $('#loginInfo').hide();
            }
        });
        event.preventDefault();
    });
	
    $('#email').change(function () {
        var email = $('#email').val();
        $('#emailMessage').empty();

        $.ajax({
            url: 'ValidateEmail',
            type: 'POST',
            data: {
                //__RequestVerificationToken: token,
                email: email
            },
            success: function (data) {
                $('#emailMessage').append('<span>' + data.message + '</span>');
            }
        });
    });

    $('#passwordAgain').keyup(function () {
        var password = $('#password').val();
        var passwordAgain = $('#passwordAgain').val();
		var goodColor = "#66cc66";
		var badColor = "#ff6666";
		$('#passwordMessage').empty();

		if (password != passwordAgain) {
			$('#passwordAgain').style.color = badColor;
            $('#passwordMessage').append('<span>Lösenorden matchar inte varandra</span>');
		} else {
			
            $('#passwordMessage').append('<span>Lösenorden matchar varandra</span>');
		}
		//Compare the values in the password field 
		//and the confirmation field
		if (password == passwordAgain) {
			//The passwords match. 
			//Set the color to the good color and inform
			//the user that they have entered the correct password 
			$('#passwordAgain').style.color = goodColor;
			$('#passwordMessage').append('<span>Lösenorden matchar varandra</span>');
		} else {
			//The passwords do not match.
			//Set the color to the bad color and
			//notify the user.
			$('#passwordMessage').append('<span>Lösenorden matchar inte varandra</span>');
		}
    });
</script>